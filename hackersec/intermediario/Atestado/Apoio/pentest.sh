#!/bin/bash

# Recebe o endereço IP como entrada
IP=$1

# Cria um arquivo para salvar a saída de cada comando
output_dir=$(date +%Y-%m-%d_%H-%M)_output
mkdir $output_dir
chmod -R 777 ./

# Executa o OpenVas e salva a saída em um arquivo
gvm-start
echo "9e2fa185-854f-4c9f-b6ca-ac8ef343d853"

# Executa o WhatWeb e salva a saída em um arquivo 
whatweb $IP --color=never -v > $output_dir/whatweb_output.txt ;

# Executa o ffuf e salva a saída em um arquivo #! FIXME: O CÓDIGO ESTÁ DANDO ERRO NA HORA DE SALVAR O ARQUIVO. #TODO: VERIFICAR O FORMATO DE SAÍDA
# ffuf -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -u http://$IP/FUZZ -t 10 -v -o $output_dir/ffuf_output.txt ;

# Executa o gobuster e salva a saída em um arquivo
gobuster dir -e -u http://$IP -w /usr/share/wordlists/dirb/big.txt --no-color -x .php,.html -o $output_dir/gobuster_output.txt ;

# Executa o wfuzz e salva a saída em um arquivo #! FIXME: O CÓDIGO ESTÁ DANDO ERRO ALEGANDO EXCESSO DE ARGUMENTOS. #TODO: VERIFICAR OS ARGUMENTOS UTILIZADOS
# wfuzz -z file,/usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt --hc 404 http://example.com/FUZZ -v

# Executa o dirb e salva a saída em um arquivo
dirb http://$IP /usr/share/dirb/wordlists/big.txt -w -o $output_dir/dirb_output.txt ;

# Executa o nikto e salva a saída em um arquivo
nikto -host http://$IP/ -oq $output_dir/nikto_output.txt ;

# Executa o nmap e salva a saída em um arquivo
cd /usr/share/nmap/scripts && nmap -sC -sV -vv -O -Pn --script=vuln $IP -oN $output_dir/nmap_output.txt;

# Executa o WPScan e salva a saída em um arquivo
wpscan --url http://$IP/ -o $output_dir/wpscan_output.txt

# Executa o SSLScan e salva a saída em um arquivo
sslscan $IP --no-colour --verbose > $output_dir/sslscan_output.txt

# Executa o sqlmap e salva a saída em um arquivo
touch sqlmap_output.txt
sqlmap -u $IP -o $output_dir/sqlmap_output.txt;

# Concatena todos os arquivos de saída em um único arquivo
touch all_output.txt
cat $output_dir/* > $output_dir/all_output.txt

# Abre o Metasploit
konsole msfconsole &

echo "Concluído! Os resultados estão salvos no diretório $output_dir"
